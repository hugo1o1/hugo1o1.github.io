<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Es modules 原理 | hugo Spaces</title>
    <meta name="description" content="Vite & Vue powered static site generator.">
    <link rel="stylesheet" href="/assets/style.fa670543.css">
    <link rel="modulepreload" href="/assets/chunks/ui-custom.4203cadd.js">
    <link rel="modulepreload" href="/assets/chunks/ui-custom.7e73f761.js">
    <link rel="modulepreload" href="/assets/chunks/AlgoliaSearchBox.aceaab34.js">
    <link rel="modulepreload" href="/assets/app.6741d607.js">
    <link rel="modulepreload" href="/assets/JavaScript_es-modules_1.es modules 原理.md.18114a91.lean.js">
    
    <meta name="twitter:title" content="Es modules 原理 | hugo Spaces">
  <meta property="og:title" content="Es modules 原理 | hugo Spaces">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="hugo Spaces, back to home" data-v-675d8756 data-v-cc01ef16><!----> hugo Spaces</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/posts/" data-v-b8818f8c>posts <!----></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/vuejs/vitepress" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--[--><div class="algolia-search-box" id="docsearch"></div><!--]--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/posts/" data-v-b8818f8c>posts <!----></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/vuejs/vitepress" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><p class="sidebar-link-item">JavaScript</p><ul class="sidebar-links"><li class="sidebar-link"><p class="sidebar-link-item">HTML</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/JavaScript/HTML/defer_async">defer_async</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/JavaScript/HTML/dom 属性">dom 属性</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/JavaScript/HTML/layout thrashing">layout thrashing</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">es-modules</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/JavaScript/es-modules/1.es modules 原理">1.es modules 原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/JavaScript/es-modules/2.es modules 如何实现动态引入">2.es modules 如何实现动态引入</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">h5视频传输</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/JavaScript/h5视频传输/h5视频传输">h5视频传输</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">husky</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/JavaScript/husky/1">1</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">react</p><ul class="sidebar-links"><li class="sidebar-link"><p class="sidebar-link-item">useEffect</p><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">router</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/JavaScript/router/1.URL和URI">1.URL和URI</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/JavaScript/router/2.hash vs browser">2.hash vs browser</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">一篇文章搞懂事件循环机制</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/JavaScript/一篇文章搞懂事件循环机制/一篇文章搞懂事件循环机制">一篇文章搞懂事件循环机制</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">包管理器</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/JavaScript/包管理器/1">1</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">微前端探索</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/JavaScript/微前端探索/(转)乾坤原理">(转)乾坤原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/JavaScript/微前端探索/探索和思考">探索和思考</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">调度场算法-eval 的实现</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/JavaScript/调度场算法-eval 的实现/1">1</a><!----></li></ul></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">algo</p><ul class="sidebar-links"><li class="sidebar-link"><p class="sidebar-link-item">heap</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/algo/heap/index">index</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">isExpressionValid</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/algo/isExpressionValid/index">index</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">zigzagTable</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/algo/zigzagTable/index">index</a><!----></li></ul></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">compilers</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/compilers/1.概述">1.概述</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/compilers/2.一个简单的语法转换的例子">2.一个简单的语法转换的例子</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">english-learning</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/english-learning/fiddle">fiddle</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/english-learning/wordsnote">wordsnote</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">nodeJS</p><ul class="sidebar-links"><li class="sidebar-link"><p class="sidebar-link-item">命令行工具生成博客模板</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/nodeJS/命令行工具生成博客模板/命令行工具生成博客模板">命令行工具生成博客模板</a><!----></li></ul></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">regExp</p><ul class="sidebar-links"><li class="sidebar-link"><p class="sidebar-link-item">正则表达式入门</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/regExp/正则表达式入门/正则表达式入门">正则表达式入门</a><!----></li></ul></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">self-reflecting</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/self-reflecting/1. 武志红-不要说我不行，停止内耗">1. 武志红-不要说我不行，停止内耗</a><!----></li><li class="sidebar-link"><p class="sidebar-link-item">dailynote</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/self-reflecting/dailynote/2021-11-13">2021-11-13</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/self-reflecting/dailynote/2022-11-15">2022-11-15</a><!----></li></ul></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">stock</p><ul class="sidebar-links"><li class="sidebar-link"><p class="sidebar-link-item">日本蜡烛图技术</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/stock/日本蜡烛图技术/1.技术分析的重要性">1.技术分析的重要性</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">涛动周期论</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/stock/涛动周期论/readme">readme</a><!----></li></ul></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">test</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/test/hello">hello</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--[--><div id="ads-container"><div class="carbon-ads" ref_key="el" data-v-5941b830></div></div><!--]--><!--[--><!--]--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><p>参考： <a href="https://hacks.mozilla.org/2018/03/es-modules-a-cartoon-deep-dive/" target="_blank" rel="noopener noreferrer">ES modules: A cartoon deep-dive</a><a href="https://tc39.es/ecma262/#sec-modules" target="_blank" rel="noopener noreferrer">Es modules spec </a></p><h2 id="es-modules-原理" tabindex="-1">Es modules 原理 <a class="header-anchor" href="#es-modules-原理" aria-hidden="true">#</a></h2><p>当有一个入口文件长这样：</p><div class="language-javascript"><pre><code>  <span class="token comment">// main.js entry</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">A</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./a.js&#39;</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">B</span><span class="token punctuation">}</span> ffrom <span class="token string">&#39;./b.js&#39;</span>

</code></pre></div><p>浏览器拿到具体的某个文件也没办法，需要将它转化成更能理解的 <strong>模块记录</strong>（Module record） <img src="/assets/module_record.fa813cb0.png" alt="Module record"></p><p>模块记录接下来会被转化成模块实例，一个模块实例由 代码 和 状态组成。 代码 就是 原生的代码， 状态 是 在当前某个时刻下变量具体的值。 <img src="/assets/code&amp;state.aa2de6be.png" alt="Module record"></p><p>我们要做的就是将每一个模块文件转换为一个模块实例。模块加载的过程就是从入口文件开始，经过一系列的引入编程一个 模块实例的依赖图。 对于 一个 Es modules, 一共经历 3 步。</p><ul><li>构造阶段（Construction）— 找到并下载文件，将文件转化为模块记录</li><li>实例化阶段（Instantiation）— 找到存储变量的内存映射表，将导入和导出指向内存中的块，这个步骤称为链接（linking）</li><li>计算（Evaluation) — 运行代码 计算变量实际的值并填充 <img src="/assets/3steps.e2b8a83f.png" alt="3 steps"></li></ul><p>可以这样说 es modules 是异步的， 因为这种模块化的加载方式可以拆分为 构造、实例化、计算 三个步骤， 这三个阶段都能够分开进行。 commonjs 不同的是，所有的依赖都会一次性加载、实例化和计算，中间不能中断。</p><p>es modules 的特性决定了怎么将将文件转换为模块记录、怎么构造和实例化和计算，但是怎么加载文件是由 loader 决定的，在浏览器中就是通过 HTML 加载器加载的，这在不同的平台会有所区别。 <img src="/assets/main2phases.bf62bf89.png" alt="main2phases"></p><p>接下来具体介绍 构造、实例化、再计算的具体过程。</p><h4 id="构造" tabindex="-1">构造 <a class="header-anchor" href="#构造" aria-hidden="true">#</a></h4><p>构造阶段包含三个步骤：</p><ol><li>找到模块文件下载地址</li><li>根据 URL 下载文件或者从文件系统加载</li><li>将文件转化为 模块记录</li></ol><h6 id="找到文件并加载" tabindex="-1">找到文件并加载 <a class="header-anchor" href="#找到文件并加载" aria-hidden="true">#</a></h6><p>loader 会帮你找到文件并下载。首先会从入口文件开始，在 HTML 中，通过使用脚本标记告诉加载程序在哪里找到它。</p><div class="language-javascript"><pre><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&#39;main.js&#39;</span> type<span class="token operator">=</span><span class="token string">&#39;module&#39;</span><span class="token operator">&gt;</span>
</code></pre></div><p>但是它如何找到下一组模块呢  — main.js 直接依赖于哪些模块？</p><p>这就是导入语句的用武之地。import 语句的一部分称为模块说明符。它告诉加载程序在哪里可以找到下一个模块。 <img src="/assets/fromMain.8457bf4c.png" alt="fromMain"> 关于模块说明符号，HTML 和 node 等不同平台表现不太一致。 在修复之前，浏览器只接受 URL 作为模块说明符。他们将从该 URL 加载模块文件。但这不会同时发生在整个图形中。在解析文件之前，您不知道模块需要您获取哪些依赖项……在获取文件之前，您无法解析文件。</p><p>这意味着我们必须逐层遍历树，解析一个文件，然后找出它的依赖项，然后找到并加载这些依赖项。 <img src="/assets/nested_deps.044c2447.png" alt=""> 如果主线程等待这些文件下载，那么其他的任务将会被压入队列。 在浏览器中加载资源会占用比较长的时间。 <img src="/assets/download_cost.b29d498b.png" alt=""></p><p>阻塞主线程将会使那些使用模块来构建的 app 运行很慢。这也是 ES 模块规范将实现算法划分成多个阶段的原因之一。将构建阶段单独划分出来允许浏览器在处理同步的实例化阶段之前就能够下载文件并且构建模块依赖图。</p><p>拆分成多个阶段的算法是 CommonJs 和 Esm 的主要区别之一。</p><p>因为从文件系统中加载文件速度很快，CommonJs 可以在加载文件的时候就进行实例化和计算操作，同时也意味着在你 return 一个模块实例的同时，已经访问完整个依赖树，并实例完和计算完所有的依赖。</p><p><img src="/assets/commonJs_steps.24135624.png" alt=""> 因为上述这些特性使得我们的在 CommonJs 中是可以在模块引入中使用变量的。 就像下面的例子：</p><p>当你执行到 require 语句时，你已经完成了上面所有依赖的实例和计算，这时的变量是有值的。</p><p>但对于 ES 模块，在进行任何计算之前，需要事先构建整个模块图。这意味着模块说明符中不能有变量，因为这些变量还没有值。</p><blockquote><p>使用变量引入是非常必要的，因为你常常会想要根据环境加载不同的依赖。</p></blockquote><h6 id="转化" tabindex="-1">转化 <a class="header-anchor" href="#转化" aria-hidden="true">#</a></h6><p>现在我们已经获取到了这个文件，我们需要将它解析为一条模块记录。这会帮助浏览器知道这些模块不一样的部分。 <img src="/assets/parsing1.8be34e90.png" alt=""> 一旦这条模块记录被创建，它将会被放置到模块映射集合内。这就意味着，无论何时它在这被请求，加载器都会从映射集合中录取它。 <img src="/assets/module_map.b5dda9f1.png" alt=""> 在编译过程中有一个看似微不足道的细节，但是它却有着重大的影响。所有的模块被解析后都会被当做在顶部有 use strict。还有另外两个细节。用例子来说明吧，await 关键词会被预先储备到模块代码的最顶部，以及顶级作用域中 this 是 undefined。 这种不同的解析方式被称作“解析目标”。如果你解析相同的文件，但是目标不同，你将会得到不同的结果。因此，在开始解析你要解析的文件类型之前，你需要知道它是否是一个模块。 在浏览器中，这将非常的简单，你只需要在 script 标签中设置 type=&quot;module&quot;。这就会告诉浏览器，这个文件将被当做模块进行解析。以及只有模块才能被引用，浏览器知道任意引入都是模块。</p><p><img src="/assets/parsing2.c73236ec.png" alt=""> 但是在 Node 端，你不会使用到 HTML 标签，所以你没办法去使用 type 属性。社区为此想出了一个解决办法，对于这类文件使用了 mjs 的扩展名。通过这个扩展名告诉 Node，“这是一个模块”。你可以看出人们把这个视为解析目标的信号。这个讨论仍在进行中，现在还不清楚最后 Node 社区会采用哪种信号。 无论哪种方式，加载器将会决定是否将一个文件当做模块去处理。如果这是一个模块并且存在引用，那么它将会再次进行刚才的过程，直到所有的文件都被获取到，解析完。 <img src="/assets/module_records.1c93d013.png" alt=""></p><h4 id="实例化" tabindex="-1">实例化 <a class="header-anchor" href="#实例化" aria-hidden="true">#</a></h4><p>像我刚才提到的，一个实例由代码和状态构成。状态存在于于内存，所以整个实例化的步骤是关于如何与内存建立联系的。</p><p>首先，将 JS 引擎创立一个模块环境记录。这管理了模块记录要用的变量，然后找到所有导出对应的内存盒子。模块环境记录就会持续跟踪这些与各处导出相关的内存盒块中。</p><p>这些内存块在后面的计算完成之前并不会赋值。有一点要注意的就是： 所有的方法申明都是在这个阶段初始化。这会方便后边的计算阶段。</p><p>在实例化一个模块图的时候，引擎会做一个深度优先后序遍历。也就是说，引擎会先遍历到图的底部节点，先对没有其他依赖的模块进行实例化。</p><p><img src="/assets/module_environment_record.2d434426.png" alt=""></p><p>当引擎处理完一个模块所有的导出(exports)之后，就会重新回到顶层去处理所有的引入（imports）</p><p>要注意的是导入和导出都指向内存中的同一个位置。将导出在内存中绑定的前提是所有的导入都能找到对应的导出。</p><p><img src="/assets/imports&amp;exports.8adf7500.png" alt=""></p><p>这里和 CommonJs 是有很大区别的。在 CommonJs 里面，整个导出的对象都是导出的一份拷贝，所有的值都是备份的。如果导出的模块改变了某一个值，引入的模块是不能感知到变化（存储的还是旧值） <img src="/assets/value_copy.59472208.png" alt=""></p><p>但是在 Es module 里，使用的是 live bindings。 所有的模块都指向内存中的同一位置。当导出的模块的值发生改变，引入的模块该值也会发生变化。</p><p>**导出值的模可以在任何时候改变这个值，引入该值的模块却不能改变这个值。也就是说，如果一个模块引入可一个对象，不能改变这个对象的引用，但是却可以改变对象的属性。 <img src="/assets/import_values_not_change.7f5d6934.png" alt=""></p><p>使用 Live binding 的原因是，可以不用运行代码就将变量绑定内存。这能够帮助处理计算阶段的循环依赖，接下来将会提到。</p><p>完成这个阶段之后，我们将能够得到模块的实例和与内存关联的导入和导出的变量。</p><h4 id="计算" tabindex="-1">计算 <a class="header-anchor" href="#计算" aria-hidden="true">#</a></h4><p>在计算阶段，主要是将实例化步骤中建立关联的内存块赋值。 js 引擎将会执行顶部的代码——除了函数声明之外的代码。</p><p>除了为内存块赋值，计算阶段还会执行一些副作用代码。比如，一个模块可能会发送 http 请求向 server 保存数据。 <img src="/assets/side_effect.14998a5c.png" alt=""></p><p>因为副作用可能会有潜在的影响，所以不会想要一个模块执行多次计算阶段。尽管在实例化阶段，可能会自顶向下执行多次，但是得到的结果会是一样的，而计算阶段，只会执行一次，副作用也会因为时机不同，得到不同的结果。</p><p>这就是引入 module map 的原因，module map 能够根据 URL  缓存模块，保证一个模块只有一个模块记录。</p><p>循环依赖是怎么解决的呢？</p><p>在循环依赖中，你遇到的通常是比较大的圈。为了方便解释问题，我们使用一个简化的例子。</p><p>来看看 CommonJs 是怎么解决的，首先 main 会执行 require 语句，然后加载 counter 模块。 <img src="/assets/loop1.f7c63019.png" alt=""> counter 模块尝试去获取 message 的值，因为 message 还没有在 main 中计算赋值，所以这时的值是 undefined. <img src="/assets/loop2.783610c0.png" alt=""></p><p>下面的计时器开始注册，main 模块开始解析，message 被赋值，但是因为是拷贝的原因，计时器执行获得的 message 还是 undefined . <img src="/assets/loop3.f4130445.png" alt=""> 而因为 Es module 的热绑定，计时器注册时 message 是 undefind, 但是执行时是被赋值的。 <img src="/assets/loop4.a6ad6126.png" alt=""></p><h4 id="es-模块的当前状态" tabindex="-1">es 模块的当前状态 <a class="header-anchor" href="#es-模块的当前状态" aria-hidden="true">#</a></h4><p>随着 Firefox 60 在五月早期的发布，所有主流浏览器都将默认支持 ES 模块了。Node 也添加了对其的支持，并且有一个致力于解决 CommonJS 和 ES 模块之间的兼容性的问题的工作小组在不断地努力。 这意味着，你将可以使用 type=module 的方式来使用模块的导入和导出。然而，更多的模块特性也即将到来。处于 Stage 3 的提案 dynamic import 也在具体的进程中。import.<wbr>meta 也是如此，它将支持 Node 上的一些用例。同时 module resolution 提案也会使得在浏览器和 Node.js 之间的差别变得更加平滑细微。所以我们能够期待未来可以鞥更好地使用模块。</p><h4 id="核心问题" tabindex="-1">核心问题 <a class="header-anchor" href="#核心问题" aria-hidden="true">#</a></h4><ol><li>CommonJS 和 Es module 如何解决循环依赖的？</li></ol></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-07c132fc><div class="edit" data-v-07c132fc><div class="edit-link" data-v-07c132fc data-v-1ed99556><a class="link" href="https://github.com/vuejs/vitepress/edit/main/docs/JavaScript/es-modules/1.es modules 原理.md" target="_blank" rel="noopener noreferrer" data-v-1ed99556>Edit this page on GitHub <svg class="icon outbound icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-1ed99556><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="updated" data-v-07c132fc><!----></div></footer><!----><!--[--><!--[--><!--]--><!--[--><div class="buy-sell-ads" data-v-4ce5ad17><div class="bsa-cpc" data-v-4ce5ad17></div></div><!--]--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"javascript_html_defer_async.md\":\"00f35423\",\"javascript_html_dom 属性.md\":\"b6f24fa8\",\"javascript_html_layout thrashing.md\":\"c9548054\",\"javascript_es-modules_1.es modules 原理.md\":\"18114a91\",\"javascript_es-modules_2.es modules 如何实现动态引入.md\":\"0ed1af0d\",\"javascript_h5视频传输_h5视频传输.md\":\"d77c6726\",\"javascript_husky_1.md\":\"ad281e91\",\"javascript_router_1.url和uri.md\":\"0253dbcf\",\"javascript_router_2.hash vs browser.md\":\"57d6bfa1\",\"javascript_一篇文章搞懂事件循环机制_一篇文章搞懂事件循环机制.md\":\"95bcf4be\",\"javascript_包管理器_1.md\":\"3430167a\",\"javascript_微前端探索_(转)乾坤原理.md\":\"a6f4667e\",\"javascript_微前端探索_探索和思考.md\":\"d8ff2eac\",\"javascript_调度场算法-eval 的实现_1.md\":\"dba99f92\",\"algo_heap_index.md\":\"8e4cc209\",\"algo_isexpressionvalid_index.md\":\"e4b1e9eb\",\"algo_zigzagtable_index.md\":\"662f4212\",\"compilers_1.概述.md\":\"55e221c5\",\"compilers_2.一个简单的语法转换的例子.md\":\"2c28a770\",\"english-learning_fiddle.md\":\"d0327591\",\"english-learning_wordsnote.md\":\"8dae5b0c\",\"nodejs_命令行工具生成博客模板_命令行工具生成博客模板.md\":\"98880d72\",\"regexp_正则表达式入门_正则表达式入门.md\":\"6f72a5f6\",\"self-reflecting_1. 武志红-不要说我不行，停止内耗.md\":\"5835b54f\",\"self-reflecting_dailynote_2021-11-13.md\":\"bf5441dc\",\"self-reflecting_dailynote_2022-11-15.md\":\"48302456\",\"stock_日本蜡烛图技术_1.技术分析的重要性.md\":\"232f846f\",\"stock_涛动周期论_readme.md\":\"07c8521f\",\"test_hello.md\":\"a2da10b4\"}")</script>
    <script type="module" async src="/assets/app.6741d607.js"></script>
    
  </body>
</html>